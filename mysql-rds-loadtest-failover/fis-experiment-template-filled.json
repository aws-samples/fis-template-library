{
    "description": "MySQL RDS Load Test and Failover Experiment",
    "targets": {
        "EC2Instance": {
            "resourceType": "aws:ec2:instance",
            "resourceArns": [
                "arn:aws:ec2:us-east-1:386742307312:instance/i-06180e4904ccf5c08"
            ],
            "selectionMode": "ALL"
        },
        "DBInstances": {
            "resourceType": "aws:rds:db",
            "resourceArns": [
                "arn:aws:rds:us-east-1:386742307312:db:mysql-rds-loadtest-failover-rdsinstance-7lnsqbmo9icy"
            ],
            "selectionMode": "ALL"
        }
    },
    "actions": {
        "RunLoadTest": {
            "actionId": "aws:ssm:send-command",
            "description": "Run MySQL load test using Systems Manager document",
            "parameters": {
                "documentArn": "arn:aws:ssm:us-east-1:386742307312:document/mysql-rds-loadtest-failover-SSMLoadTestDocument-zDiY3BrTEbQs",
                "documentParameters": "{\"Duration\":\"300\",\"Concurrency\":\"10\",\"DBHost\":\"mysql-rds-loadtest-failover-rdsinstance-7lnsqbmo9icy.ck3zxsrxdcgk.us-east-1.rds.amazonaws.com\",\"DBName\":\"testdb\",\"DBUsername\":\"admin\",\"DBPassword\":\"DBPassword!\"}",
                "duration": "PT10M"
            },
            "targets": {
                "Instances": "EC2Instance"
            }
        },
        "ForceFailover": {
            "actionId": "aws:rds:reboot-db-instances",
            "description": "Force a failover by rebooting the primary instance with failover",
            "parameters": {
                "forceFailover": "true"
            },
            "targets": {
                "DBInstances": "DBInstances"
            },
            "startAfter": ["RunLoadTest"]
        }
    },
    "stopConditions": [
        {
            "source": "none"
        }
    ],
    "roleArn": "arn:aws:iam::386742307312:role/mysql-rds-loadtest-failover-FISExperimentRole-luB3Gesjweym",
    "logConfiguration": {
        "logSchemaVersion": 2,
        "cloudWatchLogsConfiguration": {
            "logGroupArn": "arn:aws:logs:us-east-1:386742307312:log-group:/aws/fis/experiment:*"
        }
    },
    "tags": {
        "Name": "MySQL-RDS-LoadTest-Failover",
        "Environment": "Test",
        "Application": "RDS-Failover-Testing"
    },
    "experimentOptions": {
        "accountTargeting": "single-account",
        "emptyTargetResolutionMode": "fail"
    }
}
